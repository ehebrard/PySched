

\begin{frame}
\frametitle{Time-tabling algorithm: satisfiability check}

\begin{columns}
	\column{.35\textwidth}

	\begin{myblock}{Resource profile}
		\uncover<2->{
		\begin{itemize}
			\item Compute compulsory parts
			\uncover<3->{
			\item Sort ``events'' (start and end times of compulsory parts) ($O(n \log n)$)
			}
			\uncover<4->{
			\item Process events to compute the profile \memph{$P$} ($O(n)$)
			}
			\uncover<5->{
			\item \memph{Sweep} algorithm \mycite{BeldiceanuCarlsson01} (more general)
			}
		\end{itemize}
		}
	\end{myblock}

	\column{.65\textwidth}
	\begin{colorschedfigure}{.28}
		\input{ex/timetabling_profile.tex}
				\uncover<3>{
					\draw[color=bostonuniversityred, densely dotted, thick] (4,-6) -- (4,-17.8);
					\node[color=bostonuniversityred] at (4,-18.5) {\tiny +4};
					\draw[color=bostonuniversityred, densely dotted, thick] (7,-6) -- (7,-18.8);
					\node[color=bostonuniversityred] at (7,-19.5) {\tiny -4};

					\draw[color=bostonuniversityred, densely dotted, thick] (9,-10) -- (9,-17.8);
					\node[color=bostonuniversityred] at (8.8,-18.5) {\tiny +4};
					\draw[color=bostonuniversityred, densely dotted, thick] (12,-4) -- (12,-17.8);
					\node[color=bostonuniversityred] at (12,-18.5) {\tiny +3};
					\node[color=bostonuniversityred] at (12,-19.5) {\tiny -4,-2};
					\draw[color=bostonuniversityred, densely dotted, thick] (10,-4) -- (10,-17.8);
					\node[color=bostonuniversityred] at (10.2,-18.5) {\tiny +2};
					\draw[color=bostonuniversityred, densely dotted, thick] (15,-14) -- (15,-18.8);
					\node[color=bostonuniversityred] at (15,-19.5) {\tiny -4};

					\draw[color=bostonuniversityred, densely dotted, thick] (16,0) -- (16,-17.8);
					\node[color=bostonuniversityred] at (16,-18.5) {\tiny +4};
					\draw[color=bostonuniversityred, densely dotted, thick] (17,0) -- (17,-18.8);
					\node[color=bostonuniversityred] at (17,-19.5) {\tiny -4};

				}
	\end{colorschedfigure}
\end{columns}

\end{frame}


\begin{frame}
\frametitle{Time-tabling algorithm: bound propagator}

	\begin{itemize}
		\item Assume \memph{$\capacity=3$} and consider the profile interval \memph{$[5,10):2$}
		\uncover<2->{
		\item A task \only<2-3>{\memph{$A$} such that $[\est{A},\lst{A})$ overlaps with $[5,10)$}\only<4->{\memph{$B$} counted in the profile}
		}
		\uncover<6->{
		\item $[a,b)$ overlaps with $[\est{i},\min(\lst{i},\ect{i})) \implies \est{i} = \min(b,\lst{i})$  
		}
	\end{itemize}

\begin{center}
\begin{colorschedfigure}{.5}

\PrintTics{0,3,...,15}{1.000000}
\PrintGrid{15}{2}
% \MandatoryPartTask{0.000000}{5.000000}{15.000000}{2}{0}{A}{A}

\CProfile{{0.000000/0/5.000000/2, 5.000000/2/10.000000/0, 10.000000/0/15.000000/0}}{2}{4.700000}{A}{15.000000}

\uncover<2>{
\LeftExtensibleVariableTask{3}{15}{5}{5}{2}{0}{A}{A}
\draw[color=bostonuniversityred, very thick, dotted] (3,0) -- (3,-3);
\draw[color=bostonuniversityred, very thick, dotted] (8,0) -- (8,-3);
}
\uncover<3>{
\GroundTask{10}{5}{2}{0}{A}{A}
\PrunedExtensibleTask{3}{7}{7}{2}{0}{A}{}
}

\uncover<4-5>{
\MandatoryPartTask{2.000000}{3.000000}{13.000000}{2}{0}{A}{B}
\draw[color=bostonuniversityred, very thick, dotted] (2,0) -- (2,-3);
\uncover<4>{
\draw[color=bostonuniversityred, very thick, dotted] (10,0) -- (10,-3);
}
\uncover<5>{
\draw[color=bostonuniversityred, very thick, dotted] (7,0) -- (7,-3);
}
}
\uncover<6->{
\GroundTask{7}{8}{2}{0}{A}{B}
\PrunedExtensibleTask{2}{5}{5}{2}{0}{A}{}
}


\end{colorschedfigure}
\end{center}

\end{frame}


\begin{frame}
\frametitle{Time-tabling algorithm: bound propagator}

\begin{columns}
	\column{.35\textwidth}


	\begin{itemize}
		\item Interval \memph{$[a,b):h$}, Task \memph{$i$}
		\begin{itemize}
			\item \memph{overloaded} iff \memph{$\demand{i}+h > \capacity$}
			\item \memph{relevant} iff
				\begin{itemize}
					\item \memph{$\est{i} < b$} and
					\item \memph{$\min(\ect{i},\lst{i}) > a$}
				\end{itemize}
			% \item \memph{forbidden} iff \memph{$\min(\ect{i},\lst{i}) > a$}
		\end{itemize}
		%
		% \item Adjust \memph{$\est{i}$} to \memph{$b$} if \memph{$\exists [a,b) \in P$} of height \memph{$h$} such that:
		% \begin{itemize}
		% 	\item \memph{$\demand{i}+h > \capacity$} {\scriptsize (overload)}
		% 	\item \memph{$\min(\ect{i}, \lst{i}) > a$} {\scriptsize (is not counted in, and cannot end before, the peak)}
		% \end{itemize}
	\end{itemize}

	\uncover<2->{
	\begin{myblock}{Algorithm \mycite{OuelletQuimper13}}
	\begin{itemize}
		\item {\scriptsize compute profile}
		\uncover<3->{
		\item {\scriptsize order chuncks by decreasing \memph{$h$}}
		\item {\scriptsize for \memph{$i \in {\cal T}$} by increasing \memph{$\demand{i}$}:}
		\begin{itemize}
			\item {\scriptsize add \memph{$i$}'s over. intervals to \memph{$S$}}
			\uncover<4->{
			\item {\scriptsize get \memph{$i$}'s relevant interval in \memph{$S$}}
			\begin{itemize}
				\item $O(\log n)$ if \memph{$S$} is an AVL tree
			\end{itemize}
			}
		\end{itemize}
		}
	\end{itemize}
	\end{myblock}
	}
	\column{.65\textwidth}
	\begin{colorschedfigure}{.28}
		\input{ex/timetabling.tex}
		\uncover<3-5>{
		\draw[color=bostonuniversityred, ultra thick] (10,-17.5) -- (12,-17.5);
		}
		\uncover<4-5>{
			\node[color=bostonuniversityred] at (10,-18) {\tiny $a$};
			\node[color=bostonuniversityred] at (12,-18) {\tiny $b$};
		}
		\uncover<4>{
		\node[color=bostonuniversityred] at (5,-3.5) {\tiny $\est{E}$};
		\node[color=bostonuniversityred] at (11,-3.5) {\tiny $\min(\ect{E},\lst{E})$};
			\draw[color=bostonuniversityred, very thick, dotted] (5,-4) -- (5,-17.5);
			\draw[color=bostonuniversityred, very thick, dotted] (10,-4) -- (10,-17.5);
		}
		\uncover<5>{
		\node[color=bostonuniversityred] at (7,-13.5) {\tiny $\est{D}$};
		\node[color=bostonuniversityred] at (13,-13.5) {\tiny $\min(\ect{C},\lst{D})$};
			\draw[color=bostonuniversityred, very thick, dotted] (7,-14) -- (7,-17.5);
			\draw[color=bostonuniversityred, very thick, dotted] (12,-14) -- (12,-17.5);
		}

		\uncover<6>{
			\node[color=bostonuniversityred] at (4,-18) {\tiny $a$};
			\node[color=bostonuniversityred] at (7,-18) {\tiny $b$};
			\draw[color=bostonuniversityred, ultra thick] (9,-17.5) -- (12,-17.5);
			\draw[color=bostonuniversityred, ultra thick] (4,-17.5) -- (7,-17.5);
			\node[color=bostonuniversityred] at (6,-9.5) {\tiny $\est{C}$};
			\node[color=bostonuniversityred] at (10,-9.5) {\tiny $\min(\ect{C},\lst{C})$};
			\draw[color=bostonuniversityred, very thick, dotted] (6,-10) -- (6,-17.5);
			\draw[color=bostonuniversityred, very thick, dotted] (9,-10) -- (9,-17.5);
		}
	\end{colorschedfigure}
\end{columns}

\end{frame}

\begin{frame}
    \frametitle{Time-tabling Algorithms}

		\begin{itemize}
			\item Sweep algorithm \mycite{BeldiceanuCarlsson01}
			\item $O(n^2)$ synchornized sweep algoritm \mycite{LetortEtAl12}
			\item $O(n \log n)$ algorithm \mycite{OuelletQuimper13}
			\item $O(n)$ algorithm (not pracical) and  $O(n^2)$ efficient and simple algorithm \mycite{GayEtAl15}
		\end{itemize}

\end{frame}


\begin{frame}
    \frametitle{PySched -- Available on GitHub}
		\includegraphics[width=\textwidth]{im/code.png}
\end{frame}




